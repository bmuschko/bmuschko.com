<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="map[]" />
    
    <link rel="shortcut icon" type="image/x-icon" href="https://bmuschko.com/img/favicon.ico">
    <title>Publishing Javadocs with Gradle</title>
    <meta name="generator" content="Hugo 0.59.0" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://bmuschko.com/css/main.css" /><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/darcula.min.css">
    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-99678333-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </head>

  <body>
    <div id="wrap">

      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="https://bmuschko.com/"><i class="fa fa-home"></i></a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="/blog/">BLOG</a></li>
        
        <li><a href="/talks/">TALKS</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="https://bmuschko.com/blog/publishing-javadocs/">Publishing Javadocs with Gradle</a></strong>
          </h3>
        </div>
        <div class="blog-title">
          <h4>
            
            <span class="label label-success">java</span>
            
            <span class="label label-success">javadoc</span>
            
            <span class="label label-success">gradle</span>
            
            <span class="label label-success">documentation</span>
            
            <span class="label label-success">ci</span>
            
            <span class="label label-success">travis</span>
            
            </br></br></br>
            May 21, 2017
          </h4>
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              <div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Documentation is a must-have for any consumer-facing project. It can come in different shapes and sizes: documentation about the functionality of the project, DSL documentation, API documentation, usage examples and many more. For consumers of libraries the relevant part of the documentation often is the exposed API. In the Java world, API documentation materializes as Javadocs.</p>
</div>
<div class="paragraph">
<p>Java provides the <a href="http://www.oracle.com/technetwork/articles/java/index-jsp-135444.html"><code>javadoc</code></a> tool for generating Javadocs documentation from source code. Running the tool is a no-brainer either from the command line or as an integration with any of the build tools available, like Ant, Maven or Gradle. Even if generating Javadocs is simple, there&#8217;s still the question of making the documentation accessible to consumers, the software developers using the library. If you are in the business of writing open-source libraries then you have various options. You could just publish your artifacts to Maven Central and reference it through <a href="http://www.javadoc.io/">javadoc.io</a> (e.g. as done by the <a href="http://site.mockito.org/">Mockito project</a>). However, you might prefer to publish your artifact to a different repository so javadoc.io disqualifies as option. Another hosting platform that has become increasing popular is <a href="https://pages.github.com/">GitHub Pages</a>.</p>
</div>
<div class="paragraph">
<p>In this post you will learn how to generate Javadocs and publish them to GitHub Pages with the help of of an external plugin. Furthermore, we&#8217;ll learn of integrate the process with the Continuous Integration provider <a href="https://travis-ci.org/">Travis CI</a>.</p>
</div>
<div class="paragraph">
<p>This post won&#8217;t go into a lot of details on Java or Gradle. Please consult the relevant documentation for more information.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_generating_javadocs">Generating  Javadocs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applying the <a href="https://docs.gradle.org/current/userguide/java_plugin.html">Java plugin</a> to a Gradle build script automatically provides a task for generating Javadocs out-of-the-box. That task is called <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:javadoc"><code>javadoc</code></a>, takes the compiled source code from the <code>main</code> source set as input and builds a set of HTML pages as output. The following example code demonstrates how to apply the Java plugin to the project:</p>
</div>
<div class="paragraph">
<p><em>build.gradle</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">apply plugin: 'java'</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Listing 1. Applying the Java plugin</em></p>
</div>
<div class="paragraph">
<p>Executing the task produces the Javadoc files in the directory <em>build/docs/javadoc</em>. The following console output shows how the task execution plays out in practice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ./gradlew javadoc
:compileJava
:processResources
:classes
:javadoc

BUILD SUCCESSFUL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, let&#8217;s have a look at how to publish the Javadoc files to GitHub Pages.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_publishing_to_github_pages">Publishing to GitHub Pages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Publishing the pages is almost as easy as generating them. You might have guessed it - there&#8217;s a plugin for it. The plugin we&#8217;ll use for this example is called the <a href="https://github.com/ajoberstar/gradle-git/wiki/Github%20Pages%20Plugin">Github Pages Plugin</a>. It&#8217;s available on the <a href="https://plugins.gradle.org/plugin/org.ajoberstar.github-pages">Gradle plugin portal</a>. In the build script <code>ghpages.gradle</code>, we are applying the Github Pages Plugin. Moreover, we are configuring the plugin to map the output files from the <code>javadoc</code> task to the context path <code>docs/javadoc</code>. GitHub Pages will take the context page when exposing the URL for browsing the published artifacts. We also provide the URL of the GitHub repository. Depending on whether the environment variable <code>GH_TOKEN</code> is available, a URL is used that is either HTTPs-based or based on the <code>git</code> protocol.</p>
</div>
<div id="listing2" class="paragraph">
<p><em>ghpages.gradle</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">buildscript {
    repositories {
        jcenter()
    }

    dependencies {
        classpath 'org.ajoberstar:gradle-git:1.4.2'
    }
}

apply plugin: org.ajoberstar.gradle.git.ghpages.GithubPagesPlugin

ext {
    repoPath = 'bmuschko/gradle-docker-plugin'
    ghToken = System.getenv('GH_TOKEN')
}

githubPages {
    if (ghToken) {
        repoUri = "https://github.com/${repoPath}.git"
        credentials {
            username = ghToken
            password = ''
        }
    } else {
        repoUri = "git@github.com:${repoPath}.git"
    }

    pages {
        from(javadoc.outputs.files) {
            into 'docs/javadoc'
        }
    }
}

publishGhPages.dependsOn javadoc</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Listing 2. Using the gradle-git plugin to publish Javadocs</em></p>
</div>
<div class="paragraph">
<p>The Github Pages Plugin creates the task <code>publishGhPages</code>. By wiring it to the <code>javadoc</code> task as task dependency we make sure that the Javadocs are always created before they are published to GitHub Pages. You can find this code being used in the <a href="https://github.com/bmuschko/gradle-docker-plugin/blob/master/buildSrc/src/main/kotlin/com/bmuschko/gradle/docker/DocumentationPlugin.kt">Gradle Docker Plugin</a> if you want to have a closer look at the details. Initiating the publishing process is simple - run the corresponding publishing task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ ./gradlew javadoc
:compileJava
:processResources
:classes
:javadoc
:prepareGhPages
:publishGhPages

BUILD SUCCESSFUL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pages published to GitHub can be resolved through the HTTP URL pattern <em><a href="http://&lt;username&gt;.github.io" class="bare">http://&lt;username&gt;.github.io</a></em>. GitHub Pages organizes the published files with the name of the repository. Additionally, we provided the context path <em>docs/javadoc</em>.</p>
</div>
<div class="paragraph">
<p>In the last section of this post, we&#8217;ll have a look at automatically running the publication process through Continuous Integration.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_publishing_javadocs_with_every_commit">Publishing Javadocs with every commit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>So far we automated the whole process of generating and publishing Javadocs. But what if we wanted to run this process as part of a build and deployment pipeline? Piece of cake. To demonstrate such a setup, we&#8217;ll assume that we are building an open-source project. The following section talks about how to create a job on <a href="https://travis-ci.org/">Travis CI</a>. Be aware that a functionally similar setup can be achieved by using other Continuous Integration providers.</p>
</div>
<div class="paragraph">
<p>Getting started with Travis CI is straight forward. Log in with your GitHub account, activate the project to be built and create a <code>.travis.yml</code> for configuring the job. More information on these steps can be found on the <a href="https://docs.travis-ci.com/user/for-beginners">Travis CI getting started page</a>.</p>
</div>
<div class="paragraph">
<p>The plugin configuration in <a href="#listing2">listing 2</a> is looking for an environment variable named <code>GH_TOKEN</code>. Generate this <a href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/">access token on Github</a> under <em>Settings &gt; Personal access tokens</em>. With the access token in hand, we can now provide it to our project by configuring an environment variable on Travis CI.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/img/blog/publishing-javadocs/travis-ci-env-var.png" alt="Travis CI environment variable"></span></p>
</div>
<div class="paragraph">
<p><em>Figure 1. Declaring the Github token as environment variable on Travis CI</em></p>
</div>
<div class="paragraph">
<p>Let&#8217;s also have a look at the required Travis configuration file. As shown in <a href="#listing3">listing 3</a>, we are configuring Travis to <a href="https://docs.travis-ci.com/user/languages/java/">build a Java-based project</a> with JDK 8. The actual command of the job runs the tasks <code>build</code> and <code>publishGhPages</code> with the help of the Gradle Wrapper (which of course should be checked in with the source code).</p>
</div>
<div id="listing3" class="paragraph">
<p><em>.travis.yml</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">language: java
install: true

jdk:
  - oraclejdk8

script:
  - ./gradlew build publishGhPages

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Listing 3. Configuring the Travis CI job</em></p>
</div>
<div class="paragraph">
<p>The Travis CI job configuration assumes that a new version of the Javadocs should be published whenever there&#8217;s a compilable code change. In a more realistic setting, we&#8217;d want to publish a new version of the library artifacts at the same time though a discussion of the topic is out of scope for this post.</p>
</div>
</div>
</div>

              <hr>
              <div class="related-posts">
                <h5>Related Posts</h5>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        January 25, 2019
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/go-on-jenkins/">Building Go projects using modules on Jenkins</a></strong>
                      </h6>
                    </div>
                  </div>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        November 25, 2018
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/asciidoctorj-extension/">Writing, testing and publishing an AsciidoctorJ extension</a></strong>
                      </h6>
                    </div>
                  </div>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        November 12, 2018
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/java-project-testcontainers/">Testing a Java project with TestContainers on JUnit 5</a></strong>
                      </h6>
                    </div>
                  </div>
                
              </div>
            </div>
          </div>
          <hr>
        <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = 'bmuschko-com';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
        </div>
      </div>
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with â™¥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://bmuschko.com/js/docs.min.js"></script>
<script src="https://bmuschko.com/js/main.js"></script>

<script src="https://bmuschko.com/js/ie10-viewport-bug-workaround.js"></script><!-- Syntax highlighting -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/groovy.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



    
  </body>
</html>
